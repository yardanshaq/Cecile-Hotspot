<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Login</title>

<link rel="stylesheet" href="style.css">
<link rel="icon" href="assets/img/favicon.png">
<!-- Get Font -->
<link href="js/font.css" rel="stylesheet">
<!--Tailwind-->
<script src="js/tailwind.js"></script>
<script src="js/alpine.js"></script>
<!-- Jquery -->
<script src="js/jquery.js"></script>
<script src="/md5.js" defer></script>
</head>

<body x-data="{identitas: '', currentPath: window.location.pathname, isFormBantuan: false}" x-init="fetch('/data/identitas.json')">
<div class="max-w-sm mx-auto h-screen py-10 px-4 flex items-center">
    <div class="w-full">
    <div>
        <h1 class="font-bold text-2xl tracking-widest">Ayo Masuk.</h1>
        <h2 class="text-sm text-gray-600">Silahkan masuk sebelum terhubung ke internet</h2>
    </div>

    $(if error)
    <div class="p-2 bg-red-200 text-red-700 rounded-sm mt-4">
        $(error)
    </div>
    $(endif)

    <!-- Form login disembunyikan -->
    
    <form autocomplete="off" name="loginMember" class="mt-4" action="$(link-login-only)" method="post" onSubmit="return sendNameThenLogin()">
    <!-- Nama 
    <div class="relative bg-inherit mb-4">
        <input type="text" id="nama" name="nama"
        class="w-full peer bg-transparent h-10 rounded-lg text-teal-700 placeholder-transparent ring-2 px-4 ring-gray-200 focus:ring-teal-600 focus:outline-none"
        placeholder="Nama" required />
        <label for="nama"
        class="absolute left-0 -top-3 text-sm text-teal-500 bg-inherit mx-1 px-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-600 peer-placeholder-shown:top-2 peer-focus:-top-3 peer-focus:text-teal-600 peer-focus:text-sm transition-all">Nama</label>
    </div>-->

    <!-- Login hidden (otomatis) -->
    <div class="relative bg-inherit mb-4">
    <input type="text" id="username" name="username"
    placeholder=""
    onfocus="this.placeholder='Misal, Yardan'"
    onblur="this.placeholder=''"
    oninput="this.placeholder=''"
    autocomplete="off"
    class="peer fontQ w-full text-sm placeholder:text-m placeholder:text-gray-400 bg-transparent h-11 w-72 rounded-lg text-gray-800 ring-2 px-4 ring-gray-200 focus:ring-teal-600 focus:outline-none pt-[5px] leading-[1.1rem]" />

    <label for="username"
    class="fontQ absolute cursor-text left-3 top-3 text-base text-gray-600 bg-white px-1
    peer-placeholder-shown:top-3
    peer-placeholder-shown:text-base
    peer-placeholder-shown:text-gray-600
    peer-focus:top-[-0.9rem]
    peer-focus:text-teal-600
    peer-focus:text-sm
    transition-all duration-200 ease-in-out">
    Username
    </label>
    </div>

    <input type="hidden" name="password" value="cecile">
    <button type="submit" class="w-full bg-teal-600 text-white py-2 rounded-lg">Masuk</button>
    </form>
    $(if chap-id)
    <!-- Form Kontak -->
    <section>
        <div class="fixed z-30 overflow-y-hidden bottom-0 w-full left-0" x-show="isFormBantuan" x-transition x-cloack>
            <div class="flex items-center justify-center min-height-100vh text-center sm:block sm:p-0">
                <div class="fixed inset-0 transition-opacity">
                    <div class="absolute inset-0 bg-gray-900 opacity-75">
                </div>
                <div class="mx-auto w-full max-w-md fixed md:bottom-1/2 md:left-1/2 md:translate-y-1/2 md:-translate-x-1/2 bottom-0 left-0 rounded-t-lg md:rounded-lg bg-white">
                    <header class="flex flex-between border-b">
                    <div class="login w-full text-left p-4">
                        <b>Isi Form</b> untuk menghubungi kami
                    </div>
                    <button class="close p-4" @click="isFormBantuan = false">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>                      
                    </button>
                </header>
                <section class="p-4 grid grid-cols-1 gap-2">
                    <form id="formBantuan" action="javascript:kirimPesan()" method="post">
                        <div class="relative bg-inherit mb-4">
                            <input
                            id="name"
                            class="w-full peer bg-transparent h-10 rounded-lg text-teal-700 placeholder-transparent ring-2 px-4 ring-gray-200 focus:ring-teal-600 focus:outline-none"
                            type="text"
                            name="name"
                            placeholder="Misal. Yardan Shaquille"
                            autofocus required
                            />
                            <label
                            for="name"
                            class="label absolute left-0 -top-3 text-sm text-teal-500 bg-inherit mx-1 px-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-600 peer-placeholder-shown:top-2 peer-focus:-top-3 peer-focus:text-teal-600 peer-focus:text-sm transition-all"
                            >Nama Lengkap</label
                            >
                        </div>
                        <div class="relative bg-inherit mb-4" x-data="{ isFocused: false, hasValue: false }">
                            <select
                            id="keperluan"
                            class="w-full peer bg-transparent h-10 rounded-lg text-teal-700 ring-2 px-4 pt-2 ring-gray-200 focus:ring-teal-600 focus:outline-none"
                            name="keperluan"
                            x-model="hasValue"
                            @focus="isFocused = true"
                            @blur="isFocused = false"
                            required
                            >
                            <option value=""></option>
                            <option value="Beli Voucher">Beli Voucher</option>
                            <option value="Berlangganan Member">Berlangganan Member</option>
                            <option value="Lainnya">Lainnya</option>
                            </select>
                            <label
                            for="keperluan"
                            class="absolute left-0 text-sm mx-1 px-3 transition-all bg-white"
                            :class="(isFocused || hasValue) ? 'text-teal-600 -top-3 text-sm' : 'text-gray-600 top-2 text-base'"
                            >
                            Keperluan
                            </label>
                        </div>
                        <div class="relative bg-inherit mb-4">
                            <input
                            id="whatsapp"
                            class="w-full peer bg-transparent h-10 rounded-lg text-teal-700 placeholder-transparent ring-2 px-4 ring-gray-200 focus:ring-teal-600 focus:outline-none"
                            type="text"
                            name="whatsapp"
                            placeholder="Misal. 6281234567890"
                            autofocus required
                            />
                            <label
                            for="whatsapp"
                            class="label absolute left-0 -top-3 text-sm text-teal-500 bg-inherit mx-1 px-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-600 peer-placeholder-shown:top-2 peer-focus:-top-3 peer-focus:text-teal-600 peer-focus:text-sm transition-all"
                            >No. Whatsapp</label
                            >
                        </div>
                        <div class="relative bg-inherit mb-4">
                            <textarea
                            id="pesan"
                            class="w-full peer bg-transparent h-28 rounded-lg text-teal-700 placeholder-transparent ring-2 px-4 pt-3 ring-gray-200 focus:ring-teal-600 focus:outline-none resize-none"
                            type="text"
                            name="pesan"
                            rows="4"
                            placeholder="Misal. Saya tidak dapat terhubung kejaringan"
                            autofocus required
                            ></textarea>
                            <label
                            for="pesan"
                            class="label absolute left-0 -top-3 text-sm text-teal-500 bg-inherit mx-1 px-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-600 peer-placeholder-shown:top-2 peer-focus:-top-3 peer-focus:text-teal-600 peer-focus:text-sm transition-all"
                            >Pesan</label
                            >
                        </div>
                        
                        <button type="submit" class="w-full bg-teal-600 p-4 flex items-center justify-center gap-1 border _shadow rounded-lg  text-gray-100">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 -rotate-45">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                            </svg>

                            <span class="text-md tracking-wide">Kirim Pesan</span>           
                        </button>
                    </form>
                </section>
              </div>
            </div>
        </div>
    </section>
    <!-- End Form Kontak -->
    $(endif)

    <script type="text/javascript">
        function memberLogin() {
        const user = document.getElementById('username').value;
        const pass = document.getElementById('password').value;
        const chapId = "$(chap-id)";
        const chapChallenge = "$(chap-challenge)";
        const hashed = hexMD5(chapId + pass + chapChallenge);
        document.loginMember.username.value = user;
        document.loginMember.password.value = hashed;
        return true;
        }

        function sendNameThenLogin() {
        const nama = document.getElementById('nama').value;
        if (nama.trim() !== '') {
        document.cookie = `identitas=${encodeURIComponent(nama)}; path=/`;
        }
        return true;
        }
        function kirimPesan() {
        $.getJSON("../data/identitas.json", function(data){
        var keperluan = document.getElementById('keperluan');
        var nama = document.getElementById('name');
        var whatsapp = document.getElementById('whatsapp');
        var pesan = document.getElementById('pesan');
    
        var gabungan = 'Keperluan%3A ' + keperluan.value + '%0ANama%3A ' + nama.value + '%0AWhatsapp%3A ' + 'https://wa.me/' + whatsapp.value + '%0APesan%3A ' + pesan.value;
    
        var chat_id = data.chat_id;
        var token_bot = data.token_bot_telegram;
        // var tokenbot = '6016017922:AAEleu09o5REarKkfyenci-612msbwR0qMk'; // Ganti dengan token bot yang agan buat
        // var chat_id = '570727627'; // Ganti dengan chat id -485259792 telegram agan. Jika chat_id pribadi pastikan tanpa tanda strip -, chat dari telegram agan ke @user_chat_info_bot

        $.ajax({url: `https://api.telegram.org/bot${token_bot}/sendMessage?chat_id=${chat_id}&text=${gabungan}&parse_mode=html`, method: `POST`,});
	    document.getElementById("formBantuan").reset();
        })
        }
    </script>
    <!--<div class="mt-2">
        <span class="text-sm">Belum berlangganan? <a href="" 
            @click.prevent="isFormBantuan = true" class="text-teal-500 font-semibold">Hubungi kami</a>
        </span>
    </div>-->
    $(if trial == 'yes')
    <div class="mt-2">
        <span class="text-sm">Berbagi internet <a href="$(link-login-only)?dst=$(link-orig-esc)&amp;username=T-$(mac-esc)" class="text-teal-500 font-semibold">10 Menit</a>
        </span>
    </div>
    $(endif)
    </div>
</div>
</body>

</html>
